/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
 */
import { Component, EventEmitter, Input, Output } from '@angular/core';
import { GameManagerService } from './services/game-manager.service';
/** @type {?} */
var GAME_SPEED = 500;
/** @type {?} */
var MOVE_DOWN_SPEED = 0.2; // fraction of initial game speed
/** @enum {number} */
var GameState = {
    Paused: 0,
    Started: 1,
    Over: 2,
};
export { GameState };
GameState[GameState.Paused] = 'Paused';
GameState[GameState.Started] = 'Started';
GameState[GameState.Over] = 'Over';
var TetrisCoreComponent = /** @class */ (function () {
    function TetrisCoreComponent(_manager) {
        var _this = this;
        this._manager = _manager;
        this.rotate = false;
        this.moveLeft = false;
        this.moveRight = false;
        this.moveDown = false;
        this.start = false;
        this.stop = false;
        this.reset = false;
        this.lineCleared = new EventEmitter();
        this.gameOver = new EventEmitter();
        this.state = GameState.Paused;
        this.gridWidth = 10;
        this.gridHeight = 20;
        this._manager.lineCleared$.subscribe(function (data) { return _this._onLineCleared(data); });
        this._manager.gameOver$.subscribe(function (data) { return _this._onGameOver(data); });
    }
    /**
     * @return {?}
     */
    TetrisCoreComponent.prototype.ngOnInit = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.initialSpeed = this.initialSpeed || GAME_SPEED;
        this._moveDownSpeed = this.initialSpeed * MOVE_DOWN_SPEED;
        this._manager.initialize(this.gridWidth, this.gridHeight, this.initialSpeed, this.tileSize);
        this.grid = this._manager.grid;
        setInterval(function () {
            if (_this.moveDown) {
                _this._manager.moveDown();
            }
        }, this._moveDownSpeed);
    };
    /**
     * @param {?} changes
     * @return {?}
     */
    TetrisCoreComponent.prototype.ngOnChanges = /**
     * @param {?} changes
     * @return {?}
     */
    function (changes) {
        if (this._keyPressed(changes.moveLeft)) {
            this._manager.moveLeft();
        }
        else if (this._keyPressed(changes.moveRight)) {
            this._manager.moveRight();
        }
        if (this._keyPressed(changes.rotate)) {
            this._manager.rotate();
        }
        if (this._keyPressed(changes.start)) {
            this._manager.start();
        }
        if (this._keyPressed(changes.stop)) {
            this._manager.stop();
        }
        if (this._keyPressed(changes.reset)) {
            this._manager.reset();
        }
    };
    /**
     * @return {?}
     */
    TetrisCoreComponent.prototype.actionLeft = /**
     * @return {?}
     */
    function () { this._manager.moveLeft(); };
    /**
     * @return {?}
     */
    TetrisCoreComponent.prototype.actionRight = /**
     * @return {?}
     */
    function () { this._manager.moveRight(); };
    /**
     * @return {?}
     */
    TetrisCoreComponent.prototype.actionRotate = /**
     * @return {?}
     */
    function () { this._manager.rotate(); };
    /**
     * @return {?}
     */
    TetrisCoreComponent.prototype.actionDown = /**
     * @return {?}
     */
    function () { this._manager.moveDown(); };
    /**
     * @return {?}
     */
    TetrisCoreComponent.prototype.actionReset = /**
     * @return {?}
     */
    function () { this._manager.reset(); };
    /**
     * @return {?}
     */
    TetrisCoreComponent.prototype.actionStart = /**
     * @return {?}
     */
    function () {
        this._manager.start();
        this.state = GameState.Started;
    };
    /**
     * @return {?}
     */
    TetrisCoreComponent.prototype.actionStop = /**
     * @return {?}
     */
    function () {
        this._manager.stop();
        this.state = GameState.Paused;
    };
    /**
     * @param {?} key
     * @return {?}
     */
    TetrisCoreComponent.prototype._keyPressed = /**
     * @param {?} key
     * @return {?}
     */
    function (key) {
        return key && key.currentValue && !key.previousValue;
    };
    /**
     * @param {?} data
     * @return {?}
     */
    TetrisCoreComponent.prototype._onLineCleared = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.lineCleared.emit(data);
    };
    /**
     * @param {?} data
     * @return {?}
     */
    TetrisCoreComponent.prototype._onGameOver = /**
     * @param {?} data
     * @return {?}
     */
    function (data) {
        this.state = GameState.Over;
        this.gameOver.emit();
    };
    TetrisCoreComponent.decorators = [
        { type: Component, args: [{
                    selector: 'tetris-core',
                    template: "<board\n    [grid]=\"grid\"></board>\n"
                }] }
    ];
    /** @nocollapse */
    TetrisCoreComponent.ctorParameters = function () { return [
        { type: GameManagerService }
    ]; };
    TetrisCoreComponent.propDecorators = {
        tileSize: [{ type: Input }],
        initialSpeed: [{ type: Input }],
        rotate: [{ type: Input }],
        moveLeft: [{ type: Input }],
        moveRight: [{ type: Input }],
        moveDown: [{ type: Input }],
        start: [{ type: Input }],
        stop: [{ type: Input }],
        reset: [{ type: Input }],
        lineCleared: [{ type: Output }],
        gameOver: [{ type: Output }]
    };
    return TetrisCoreComponent;
}());
export { TetrisCoreComponent };
if (false) {
    /** @type {?} */
    TetrisCoreComponent.prototype.tileSize;
    /** @type {?} */
    TetrisCoreComponent.prototype.initialSpeed;
    /** @type {?} */
    TetrisCoreComponent.prototype.rotate;
    /** @type {?} */
    TetrisCoreComponent.prototype.moveLeft;
    /** @type {?} */
    TetrisCoreComponent.prototype.moveRight;
    /** @type {?} */
    TetrisCoreComponent.prototype.moveDown;
    /** @type {?} */
    TetrisCoreComponent.prototype.start;
    /** @type {?} */
    TetrisCoreComponent.prototype.stop;
    /** @type {?} */
    TetrisCoreComponent.prototype.reset;
    /** @type {?} */
    TetrisCoreComponent.prototype.lineCleared;
    /** @type {?} */
    TetrisCoreComponent.prototype.gameOver;
    /** @type {?} */
    TetrisCoreComponent.prototype.grid;
    /** @type {?} */
    TetrisCoreComponent.prototype.state;
    /** @type {?} */
    TetrisCoreComponent.prototype.gridWidth;
    /** @type {?} */
    TetrisCoreComponent.prototype.gridHeight;
    /** @type {?} */
    TetrisCoreComponent.prototype._moveDownSpeed;
    /** @type {?} */
    TetrisCoreComponent.prototype._manager;
}

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGV0cmlzLWNvcmUuY29tcG9uZW50LmpzIiwic291cmNlUm9vdCI6Im5nOi8vbmd4LXRldHJpcy8iLCJzb3VyY2VzIjpbInRldHJpcy1jb3JlLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7O0FBQUEsT0FBTyxFQUEwQixTQUFTLEVBQUUsWUFBWSxFQUFFLEtBQUssRUFBcUIsTUFBTSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBQ2pILE9BQU8sRUFBQyxrQkFBa0IsRUFBTyxNQUFNLGlDQUFpQyxDQUFDOztBQUV6RSxJQUFNLFVBQVUsR0FBRyxHQUFHLENBQUM7O0FBQ3ZCLElBQU0sZUFBZSxHQUFHLEdBQUcsQ0FBQzs7O0lBR3hCLFNBQVU7SUFDVixVQUFXO0lBQ1gsT0FBUTs7O29CQUZSLE1BQU07b0JBQ04sT0FBTztvQkFDUCxJQUFJOztJQStCSiw2QkFBb0IsUUFBNEI7UUFBaEQsaUJBR0M7UUFIbUIsYUFBUSxHQUFSLFFBQVEsQ0FBb0I7c0JBbkI5QixLQUFLO3dCQUNILEtBQUs7eUJBQ0osS0FBSzt3QkFDTixLQUFLO3FCQUNSLEtBQUs7b0JBQ04sS0FBSztxQkFDSixLQUFLOzJCQUVxQixJQUFJLFlBQVksRUFBRTt3QkFDckIsSUFBSSxZQUFZLEVBQUU7cUJBR2hDLFNBQVMsQ0FBQyxNQUFNO3lCQUU5QixFQUFFOzBCQUNELEVBQUU7UUFLWCxJQUFJLENBQUMsUUFBUSxDQUFDLFlBQVksQ0FBQyxTQUFTLENBQUMsVUFBQyxJQUFJLElBQUssT0FBQSxLQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxFQUF6QixDQUF5QixDQUFDLENBQUM7UUFDMUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLFVBQUMsSUFBSSxJQUFLLE9BQUEsS0FBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsRUFBdEIsQ0FBc0IsQ0FBQyxDQUFDO0tBQ3ZFOzs7O0lBRUQsc0NBQVE7OztJQUFSO1FBQUEsaUJBYUM7UUFaQyxJ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QyxhQUFhLENBQUM7Ozs7OztJQUdqRCw0Q0FBYzs7OztjQUFDLElBQUk7UUFDdkIsSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7Ozs7OztJQUd4Qix5Q0FBVzs7OztjQUFDLElBQUk7UUFDcEIsSUFBSSxDQUFDLEtBQUssR0FBRyxTQUFTLENBQUMsSUFBSSxDQUFDO1FBQzVCLElBQUksQ0FBQyxRQUFRLENBQUMsSUFBSSxFQUFFLENBQUM7OztnQkF2RjVCLFNBQVMsU0FBQztvQkFDUCxRQUFRLEVBQUUsYUFBYTtvQkFDdkIsa0RBQTJDO2lCQUU5Qzs7OztnQkFmTyxrQkFBa0I7OzsyQkFpQnJCLEtBQUs7K0JBRUwsS0FBSzt5QkFDTCxLQUFLOzJCQUNMLEtBQUs7NEJBQ0wsS0FBSzsyQkFDTCxLQUFLO3dCQUNMLEtBQUs7dUJBQ0wsS0FBSzt3QkFDTCxLQUFLOzhCQUVMLE1BQU07MkJBQ04sTUFBTTs7OEJBOUJYOztTQWlCYSxtQkFBbUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0NoYW5nZURldGVjdGlvblN0cmF0ZWd5LCBDb21wb25lbnQsIEV2ZW50RW1pdHRlciwgSW5wdXQsIE9uQ2hhbmdlcywgT25Jbml0LCBPdXRwdXR9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtHYW1lTWFuYWdlclNlcnZpY2UsIFRpbGV9IGZyb20gJy4vc2VydmljZXMvZ2FtZS1tYW5hZ2VyLnNlcnZpY2UnO1xuXG5jb25zdCBHQU1FX1NQRUVEID0gNTAwO1xuY29uc3QgTU9WRV9ET1dOX1NQRUVEID0gMC4yOyAvLyBmcmFjdGlvbiBvZiBpbml0aWFsIGdhbWUgc3BlZWRcblxuZXhwb3J0IGVudW0gR2FtZVN0YXRlIHtcbiAgICBQYXVzZWQgPSAwLFxuICAgIFN0YXJ0ZWQgPSAxLFxuICAgIE92ZXIgPSAyXG59XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAndGV0cmlzLWNvcmUnLFxuICAgIHRlbXBsYXRlVXJsOiAnLi90ZXRyaXMtY29yZS5jb21wb25lbnQuaHRtbCcsXG4gICAgLy8gc3R5bGVVcmxzOiBbJy4vdGV0cmlzLWNvcmUuY29tcG9uZW50LmNzcyddXG59KVxuZXhwb3J0IGNsYXNzIFRldHJpc0NvcmVDb21wb25lbnQgaW1wbGVtZW50cyBPbkluaXQsIE9uQ2hhbmdlcyB7XG4gICAgQElucHV0KCkgdGlsZVNpemU6IGFueTtcblxuICAgIEBJbnB1dCgpIGluaXRpYWxTcGVlZDogbnVtYmVyO1xuICAgIEBJbnB1dCgpIHJvdGF0ZSA9IGZhbHNlO1xuICAgIEBJbnB1dCgpIG1vdmVMZWZ0ID0gZmFsc2U7XG4gICAgQElucHV0KCkgbW92ZVJpZ2h0ID0gZmFsc2U7XG4gICAgQElucHV0KCkgbW92ZURvd24gPSBmYWxzZTtcbiAgICBASW5wdXQoKSBzdGFydCA9IGZhbHNlO1xuICAgIEBJbnB1dCgpIHN0b3AgPSBmYWxzZTtcbiAgICBASW5wdXQoKSByZXNldCA9IGZhbHNlO1xuXG4gICAgQE91dHB1dCgpIGxpbmVDbGVhcmVkOiBFdmVudEVtaXR0ZXI8YW55PiA9IG5ldyBFdmVudEVtaXR0ZXIoKTtcbiAgICBAT3V0cHV0KCkgZ2FtZU92ZXI6IEV2ZW50RW1pdHRlcjxhbnk+ID0gbmV3IEV2ZW50RW1pdHRlcigpO1xuXG4gICAgcHVibGljIGdyaWQ6IEFycmF5PFRpbGU+O1xuICAgIHB1YmxpYyBzdGF0ZTogR2FtZVN0YXRlID0gR2FtZVN0YXRlLlBhdXNlZDtcblxuICAgIGdyaWRXaWR0aCA9IDEwO1xuICAgIGdyaWRIZWlnaHQgPSAyMDtcblxuICAgIHByaXZhdGUgX21vdmVEb3duU3BlZWQ7XG5cbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIF9tYW5hZ2VyOiBHYW1lTWFuYWdlclNlcnZpY2UpIHtcbiAgICAgICAgdGhpcy5fbWFuYWdlci5saW5lQ2xlYXJlZCQuc3Vic2NyaWJlKChkYXRhKSA9PiB0aGlzLl9vbkxpbmVDbGVhcmVkKGRhdGEpKTtcbiAgICAgICAgdGhpcy5fbWFuYWdlci5nYW1lT3ZlciQuc3Vic2NyaWJlKChkYXRhKSA9PiB0aGlzLl9vbkdhbWVPdmVyKGRhdGEpKTtcbiAgICB9XG5cbiAgICBuZ09uSW5pdCgpIHtcbiAgICAgIHRoaXMuaW5pdGlhbFNwZWVkID0gdGhpcy5pbml0aWFsU3BlZWQgfHwgR0FNRV9TUEVFRDtcbiAgICAgIHRoaXMuX21vdmVEb3duU3BlZWQgPSB0aGlzLmluaXRpYWxTcGVlZCAqIE1PVkVfRE9XTl9TUEVFRDtcblxuICAgICAgdGhpcy5fbWFuYWdlci5pbml0aWFsaXplKHRoaXMuZ3JpZFdpZHRoLCB0aGlzLmdyaWRIZWlnaHQsIHRoaXMuaW5pdGlhbFNwZWVkLCB0aGlzLnRpbGVTaXplKTtcbiAgICAgIHRoaXMuZ3JpZCA9IHRoaXMuX21hbmFnZXIuZ3JpZDtcblxuICAgICAgc2V0SW50ZXJ2YWwoKCkgPT4ge1xuICAgICAgICBpZiAodGhpcy5tb3ZlRG93bikge1xuICAgICAgICAgIHRoaXMuX21hbmFnZXIubW92ZURvd24oKTtcbiAgICAgICAgfVxuXG4gICAgICB9LCB0aGlzLl9tb3ZlRG93blNwZWVkKTtcbiAgICB9XG5cbiAgICBuZ09uQ2hhbmdlcyhjaGFuZ2VzKSB7XG4gICAgICAgIGlmICh0aGlzLl9rZXlQcmVzc2VkKGNoYW5nZXMubW92ZUxlZnQpKSB7XG4gICAgICAgICAgICB0aGlzLl9tYW5hZ2VyLm1vdmVMZWZ0KCk7XG5cbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9rZXlQcmVzc2VkKGNoYW5nZXMubW92ZVJpZ2h0KSkge1xuICAgICAgICAgICAgdGhpcy5fbWFuYWdlci5tb3ZlUmlnaHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0aGlzLl9rZXlQcmVzc2VkKGNoYW5nZXMucm90YXRlKSkgeyB0aGlzLl9tYW5hZ2VyLnJvdGF0ZSgpOyB9XG4gICAgICAgIGlmICh0aGlzLl9rZXlQcmVzc2VkKGNoYW5nZXMuc3RhcnQpKSAgeyB0aGlzLl9tYW5hZ2VyLnN0YXJ0KCk7IH1cbiAgICAgICAgaWYgKHRoaXMuX2tleVByZXNzZWQoY2hhbmdlcy5zdG9wKSkgIHsgdGhpcy5fbWFuYWdlci5zdG9wKCk7IH1cbiAgICAgICAgaWYgKHRoaXMuX2tleVByZXNzZWQoY2hhbmdlcy5yZXNldCkpICB7IHRoaXMuX21hbmFnZXIucmVzZXQoKTsgfVxuICAgIH1cblxuICAgIHB1YmxpYyBhY3Rpb25MZWZ0KCkgeyB0aGlzLl9tYW5hZ2VyLm1vdmVMZWZ0KCk7IH1cbiAgICBwdWJsaWMgYWN0aW9uUmlnaHQoKSB7IHRoaXMuX21hbmFnZXIubW92ZVJpZ2h0KCk7IH1cbiAgICBwdWJsaWMgYWN0aW9uUm90YXRlKCkgeyB0aGlzLl9tYW5hZ2VyLnJvdGF0ZSgpOyB9XG4gICAgcHVibGljIGFjdGlvbkRvd24oKSB7IHRoaXMuX21hbmFnZXIubW92ZURvd24oKTsgfVxuICAgIHB1YmxpYyBhY3Rpb25SZXNldCgpIHsgdGhpcy5fbWFuYWdlci5yZXNldCgpOyB9XG5cbiAgICBwdWJsaWMgYWN0aW9uU3RhcnQoKSB7XG4gICAgICAgIHRoaXMuX21hbmFnZXIuc3RhcnQoKTtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IEdhbWVTdGF0ZS5TdGFydGVkO1xuICAgIH1cbiAgICBwdWJsaWMgYWN0aW9uU3RvcCgpIHtcbiAgICAgICAgdGhpcy5fbWFuYWdlci5zdG9wKCk7XG4gICAgICAgIHRoaXMuc3RhdGUgPSBHYW1lU3RhdGUuUGF1c2VkO1xuICAgIH1cblxuICAgIHByaXZhdGUgX2tleVByZXNzZWQoa2V5KSB7XG4gICAgICAgIHJldHVybiBrZXkgJiYga2V5LmN1cnJlbnRWYWx1ZSAmJiAha2V5LnByZXZpb3VzVmFsdWU7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBfb25MaW5lQ2xlYXJlZChkYXRhKSB7XG4gICAgICAgIHRoaXMubGluZUNsZWFyZWQuZW1pdChkYXRhKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIF9vbkdhbWVPdmVyKGRhdGEpIHtcbiAgICAgICAgdGhpcy5zdGF0ZSA9IEdhbWVTdGF0ZS5PdmVyO1xuICAgICAgICB0aGlzLmdhbWVPdmVyLmVtaXQoKTtcbiAgICB9XG59XG4iXX0=